<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QUESTSYSTEM · Modul-Karte (Debug)</title>
<style>
  :root{
    --bg:#0b0b0b; --fg:#f5f5f5; --grid:#1a1a1a;
    --red:#e74c3c; --yellow:#f1c40f; --blue:#3498db; --edge:#9aa4b0;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);
    font:16px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  header,footer{max-width:1200px;margin:0 auto;padding:14px 16px}
  a{color:#4aa3ff;text-decoration:none}
  .wrap{max-width:1200px;margin:0 auto;padding:0 16px 20px}
  .board{width:100%;aspect-ratio:1/1;background:#111;border-radius:12px;overflow:hidden}
  svg{width:100%;height:100%;touch-action:none}
  .grid-circ circle{fill:none;stroke:var(--grid);stroke-width:1}
  .ring{fill:none;stroke:rgba(255,255,255,.12);stroke-width:2}
  .edge{stroke:var(--edge);stroke-width:1.5;opacity:0;transition:opacity .12s linear}
  .edge.on{opacity:.95}
  .node{cursor:pointer}
  .dot{stroke:#000;stroke-width:.75;pointer-events:auto}
  .label{font-size:12px;fill:var(--fg);text-anchor:middle;pointer-events:none}
  .label.bg{fill:#000;opacity:.45}
</style>
</head>
<body>
<header>
  <a href="./">← QUESTSYSTEM</a>
  <div class="hint">Hover zeigt Verbindungen · Klick öffnet Modul</div>
</header>

<div class="wrap">
  <div class="board">
    <svg viewBox="0 0 1000 1000" xmlns:xlink="http://www.w3.org/1999/xlink">
      <g id="viewport">
        <g class="grid-circ">
          <circle cx="500" cy="500" r="140"></circle>
          <circle cx="500" cy="500" r="240"></circle>
          <circle cx="500" cy="500" r="340"></circle>
          <circle cx="500" cy="500" r="440"></circle>
        </g>
        <circle class="ring" cx="500" cy="500" r="240"></circle>
        <circle class="ring" cx="500" cy="500" r="340"></circle>
        <circle class="ring" cx="500" cy="500" r="440"></circle>
        <g id="edges"></g>
        <g id="nodes"></g>
      </g>
    </svg>
  </div>
</div>

<footer>© QUESTSYSTEM · Debug-Version</footer>

<script>
window.addEventListener("DOMContentLoaded", function(){
  console.log("✅ map.html Script gestartet");

  var nodesGroup = document.getElementById("nodes");
  var edgesGroup = document.getElementById("edges");
  console.log("nodesGroup:", nodesGroup, "edgesGroup:", edgesGroup);

  if(!nodesGroup || !edgesGroup){
    console.error("❌ SVG-Gruppen fehlen!");
    return;
  }

  // Minimal: Nur 2 Module zum Testen
  var MODULES = [
    {id:1,key:"RESETBOX",ring:"red",x:500,y:500},
    {id:2,key:"WATER",ring:"red",x:700,y:500}
  ];
  var CONNECTIONS = {1:[2]};

  // Kante
  var line = document.createElementNS("http://www.w3.org/2000/svg","line");
  line.setAttribute("x1",500); line.setAttribute("y1",500);
  line.setAttribute("x2",700); line.setAttribute("y2",500);
  line.setAttribute("class","edge");
  edgesGroup.appendChild(line);

  // Node zeichnen
  MODULES.forEach(function(m){
    var g = document.createElementNS("http://www.w3.org/2000/svg","g");
    g.setAttribute("class","node");
    g.setAttribute("transform","translate("+m.x+","+m.y+")");
    var dot = document.createElementNS("http://www.w3.org/2000/svg","circle");
    dot.setAttribute("r",9);
    dot.setAttribute("fill", m.id===1?"#e74c3c":"#3498db");
    g.appendChild(dot);
    var tx = document.createElementNS("http://www.w3.org/2000/svg","text");
    tx.setAttribute("y",-14);
    tx.setAttribute("class","label");
    tx.textContent = m.id+" "+m.key;
    g.appendChild(tx);
    nodesGroup.appendChild(g);

    g.addEventListener("mouseenter",function(){ line.classList.add("on"); });
    g.addEventListener("mouseleave",function(){ line.classList.remove("on"); });
    g.addEventListener("click",function(){ 
      window.location.assign("module.html#file=MODULES/Modul_"+("0"+m.id).slice(-2)+"_"+m.key+".md");
    });
  });

  console.log("✅ Rendering fertig");
});
</script>
</body>
</html>
