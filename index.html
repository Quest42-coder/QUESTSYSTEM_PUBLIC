<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QUESTSYSTEM ‚Äì Ring-Homepage</title>
<style>
  :root{ --bg:#0e1116; --fg:#e7eef7; --muted:#9fb0c6;
         --ring-inner:#f3c0c7; --ring-mid:#f0de94; --ring-outer:#bcd5ff;
         --node-bg:#10151f; --node-border:#2a3344; --focus:#66ccff; --shadow:0 6px 24px rgba(0,0,0,.35) }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0; font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--fg);
       background: radial-gradient(1200px 800px at 50% 40%, #131824 0%, #0c0f16 60%, #090b11 100%);}
  header{position:fixed; inset:16px 16px auto 16px; z-index:30; display:flex; gap:14px; align-items:center;
         padding:10px 14px; background:rgba(10,13,20,.6); border:1px solid #222a39; border-radius:12px; backdrop-filter: blur(6px); box-shadow:var(--shadow)}
  header a{color:var(--fg); text-decoration:none}
  .stage{position:fixed; inset:0; display:grid; place-items:center; padding:16px}
  svg{width:min(1200px,95vw); height:min(900px,90vh)}
  .ring-inner{stroke:var(--ring-inner); stroke-width:2.2; fill:none; stroke-opacity:.9}
  .ring-mid{stroke:var(--ring-mid); stroke-width:2.2; fill:none; stroke-opacity:.9}
  .ring-outer{stroke:var(--ring-outer); stroke-width:2.2; fill:none; stroke-opacity:.9}

  .node text{ font-size:15px; letter-spacing:.3px; text-anchor:middle; dominant-baseline:middle; }
  @media (min-width: 900px){ .node text{ font-size:16px; } }

  .node circle{ fill:var(--node-bg); stroke:var(--node-border); stroke-width:1.5 }
  .inner text{ fill:#5d2029 } .mid text{ fill:#6c5b00 } .outer text{ fill:#274b7a }

  .center circle{ fill:transparent; stroke:#59657c; stroke-dasharray:4 6 }
  .center text{ fill:#7f8ea8; font-weight:600; font-size:14px }

  /* Togglebare Linkliste */
  .listwrap{ position:fixed; left:16px; right:16px; bottom:16px; z-index:20;
    background:rgba(10,13,20,.85); border:1px solid #222a39; border-radius:12px;
    padding:10px 12px; max-height:32vh; overflow:auto;
    transform: translateY(calc(100% + 20px)); transition: transform .25s ease; }
  .listwrap.show{ transform: translateY(0); }
  .listwrap a{color:#9ad1ff; text-decoration:none; margin-right:10px}
  .fab{ position:fixed; right:16px; bottom:16px; z-index:25;
    background:#142034; border:1px solid #243147; color:#9ad1ff; padding:10px 14px;
    border-radius:999px; cursor:pointer; user-select:none; box-shadow:var(--shadow); font-size:14px }

  /* Linienfarben f√ºr Verbindungen */
  .link-layer{ pointer-events:none; } /* blockiert keine Klicks */
  .link-layer line{ stroke-opacity:.9; stroke-width:3.5 }
  .link-inner { stroke:#f3c0c7; }
  .link-mid   { stroke:#f0de94; }
  .link-outer { stroke:#bcd5ff; }

  .node.linked circle{ stroke:var(--focus); stroke-width:3 }
  .node.active circle{ stroke:#9ad1ff; stroke-width:3.5 }
</style>
</head>
<body>
  <header>
    <strong>üçÑ QUESTSYSTEM ‚Äì Modul-Ringe</strong>
    <span style="flex:1"></span>
    <a id="nav-dignity">Dignity Clause</a>
    <a id="nav-gebote">14 Gebote</a>
    <a id="nav-discuss">Diskussion</a>
    <a href="https://github.com/Quest42-coder/QUESTSYSTEM_PUBLIC" target="_blank" rel="noopener">Repo</a>
  </header>

  <div class="stage">
    <svg id="ringmap" viewBox="-600 -600 1200 1200"
         xmlns="http://www.w3.org/2000/svg"
         xmlns:xlink="http://www.w3.org/1999/xlink">
      <circle class="ring-inner" r="220"></circle>
      <circle class="ring-mid"   r="380"></circle>
      <circle class="ring-outer" r="540"></circle>
      <g id="reset" class="center">
        <circle r="70"></circle>
        <text x="0" y="0" text-anchor="middle" dominant-baseline="middle">RESETBOX</text>
      </g>
    </svg>
  </div>

  <div id="list" class="listwrap"></div>
  <div class="fab" id="toggleList">Module ‚ñ¥‚ñæ</div>

<script>
(function(){
  const svg=document.getElementById('ringmap');
  const list=document.getElementById('list');
  const toggleBtn=document.getElementById('toggleList');
  const BASE=(()=>{const u=new URL(location.href);if(u.pathname.endsWith('index.html'))u.pathname=u.pathname.replace(/index\.html$/,'');if(!u.pathname.endsWith('/'))u.pathname+='/';return u.origin+u.pathname;})();
  const V='links-fix';
  const urlFor=(p)=>`${BASE}module.html?file=${encodeURIComponent(p)}&v=${encodeURIComponent(V)}`;

  document.getElementById('nav-dignity').href=urlFor('MODULES/DIGNITY_CLAUSE.md');
  document.getElementById('nav-gebote').href=urlFor('14_GEBOTE_V2.1.md');
  document.getElementById('nav-discuss').href=urlFor('MODULES/14_GEBOTE_DISCUSSION.md');
  toggleBtn.addEventListener('click',()=>list.classList.toggle('show'));

  const nodes=[
    {key:"WATER",ring:"inner",file:"MODULES/Modul_02_WATER.md"},
    {key:"SHELTER",ring:"inner",file:"MODULES/Modul_03_SHELTER.md"},
    {key:"FOOD",ring:"inner",file:"MODULES/Modul_04_FOOD.md"},
    {key:"SLEEP",ring:"inner",file:"MODULES/Modul_05_SLEEP.md"},
    {key:"BODY",ring:"inner",file:"MODULES/Modul_06_BODY.md"},
    {key:"PSYCHE",ring:"inner",file:"MODULES/Modul_07_PSYCH.md"},
    {key:"DEVICE",ring:"inner",file:"MODULES/Modul_08_DEVICE.md"},
    {key:"DEBT",ring:"inner",file:"MODULES/Modul_09_DEBT.md"},
    {key:"WORK",ring:"mid",file:"MODULES/Modul_10_WORK.md"},
    {key:"SCHOOL",ring:"mid",file:"MODULES/Modul_11_SCHOOL.md"},
    {key:"BORDER",ring:"mid",file:"MODULES/Modul_12_BORDER.md"},
    {key:"NATURE",ring:"mid",file:"MODULES/Modul_13_NATURE.md"},
    {key:"HEALTH",ring:"mid",file:"MODULES/Modul_14_HEALTH.md"},
    {key:"CARE",ring:"mid",file:"MODULES/Modul_15_CARE.md"},
    {key:"FAMILY",ring:"mid",file:"MODULES/Modul_16_FAMILY.md"},
    {key:"ANIMAL",ring:"mid",file:"MODULES/Modul_17_ANIMAL.md"},
    {key:"CULTURE",ring:"mid",file:"MODULES/Modul_18_CULTURE.md"},
    {key:"MEDIA",ring:"mid",file:"MODULES/Modul_19_MEDIA.md"},
    {key:"ENERGY",ring:"mid",file:"MODULES/Modul_20_ENERGY.md"},
    {key:"CLIMATE",ring:"mid",file:"MODULES/Modul_21_CLIMATE.md"},
    {key:"MIGRATION",ring:"mid",file:"MODULES/Modul_22_MIGRATION.md"},
    {key:"JUSTICE",ring:"mid",file:"MODULES/Modul_23_JUSTICE.md"},
    {key:"COMMUNITY",ring:"mid",file:"MODULES/Modul_24_COMMUNITY.md"},
    {key:"HOUSING",ring:"outer",file:"MODULES/Modul_26_HOUSING.md"},
    {key:"TRANSPORT",ring:"outer",file:"MODULES/Modul_27_TRANSPORT.md"},
    {key:"NETWORK",ring:"outer",file:"MODULES/Modul_28_NETWORK.md"},
    {key:"SYMBOL",ring:"outer",file:"MODULES/Modul_29_SYMBOL.md"},
    {key:"TRUTH",ring:"outer",file:"MODULES/Modul_30_TRUTH.md"},
    {key:"MEMORY",ring:"outer",file:"MODULES/Modul_31_MEMORY.md"},
    {key:"LICENCE",ring:"outer",file:"MODULES/Modul_32_LICENCE.md"},
    {key:"PRIVACY",ring:"outer",file:"MODULES/Modul_33_PRIVACY.md"},
    {key:"DATA",ring:"outer",file:"MODULES/Modul_34_DATA.md"},
    {key:"CONFLICT",ring:"outer",file:"MODULES/Modul_35_CONFLICT.md"},
    {key:"DEMOCRACY",ring:"outer",file:"MODULES/Modul_37_DEMOCRACY.md"},
    {key:"KNOWLEDGE",ring:"outer",file:"MODULES/Modul_39_KNOWLEDGE.md"},
    {key:"ART",ring:"outer",file:"MODULES/Modul_40_ART.md"},
    {key:"FUTURE",ring:"outer",file:"MODULES/Modul_41_FUTURE.md"},
    {key:"DEATH",ring:"outer",file:"MODULES/Modul_42_DEATH.md"}
  ];

  const CONNECTIONS={
    WATER:["HEALTH","NATURE","FOOD","ENERGY"],
    FOOD:["HEALTH","NATURE","WORK"],
    SLEEP:["HEALTH","PSYCHE","WORK"],
    DEVICE:["DATA","PRIVACY","NETWORK","MEDIA"],
    HEALTH:["CARE","PSYCHE","BODY","WORK"],
    WORK:["SCHOOL","COMMUNITY","DEBT","DEVICE"],
    ENERGY:["CLIMATE","NETWORK","HOUSING"],
    DATA:["PRIVACY","MEDIA","TRUTH","KNOWLEDGE"],
    PRIVACY:["DATA","JUSTICE"],
    DEMOCRACY:["JUSTICE","MEDIA","TRUTH","COMMUNITY"],
    KNOWLEDGE:["SCHOOL","MEDIA","TRUTH","MEMORY"],
    ART:["CULTURE","SYMBOL","TRUTH"],
    FUTURE:["CLIMATE","KNOWLEDGE","DEATH"]
  };

  list.innerHTML=nodes.map(n=>`<a href="${urlFor(n.file)}">${n.key}</a>`).join(' ¬∑ ');

  const config={inner:{r:220,class:"inner"},mid:{r:380,class:"mid"},outer:{r:540,class:"outer"}};
  const SVG_NS="http://www.w3.org/2000/svg"; const XLINK_NS="http://www.w3.org/1999/xlink";

  const linkLayer=document.createElementNS(SVG_NS,"g"); linkLayer.setAttribute("class","link-layer");
  const posByKey=new Map(),nodeElByKey=new Map();

  function placeNodes(){
    const groups={inner:[],mid:[],outer:[]}; nodes.forEach(n=>groups[n.ring].push(n));
    Object.entries(groups).forEach(([ring,list])=>{
      const radius=config[ring].r, group=document.createElementNS(SVG_NS,"g"); group.setAttribute("class",config[ring].class); svg.appendChild(group);
      const step=(Math.PI*2)/list.length, start=(-Math.PI/2);
      list.forEach((n,idx)=>{
        const angle=start+idx*step, x=Math.cos(angle)*radius, y=Math.sin(angle)*radius;
        posByKey.set(n.key,{x,y});
        const url=urlFor(n.file);
        const a=document.createElementNS(SVG_NS,"a");
        a.setAttribute("href",url); a.setAttributeNS(XLINK_NS,"xlink:href",url); a.setAttribute("target","_self");
        a.setAttribute("transform",`translate(${x},${y})`); a.classList.add("node",config[ring].class);
        a.setAttribute('tabindex','0'); a.setAttribute('role','link'); a.setAttribute('focusable','true');
        a.setAttribute('aria-label',`${n.key} ‚Äì √∂ffnen`); nodeElByKey.set(n.key,a);
        const go=()=>{try{window.location.assign(url);}catch(e){location.href=url;}};
        a.addEventListener('click',e=>{e.preventDefault();go();});
        a.addEventListener('touchend',e=>{e.preventDefault();go();},{passive:false});
        a.addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();go();}});
        const hit=document.createElementNS(SVG_NS,"circle"); hit.setAttribute("r",58); hit.setAttribute("fill","transparent"); hit.setAttribute("pointer-events","all"); a.appendChild(hit);
        const circle=document.createElementNS(SVG_NS,"circle"); circle.setAttribute("r",44); a.appendChild(circle);
        const text=document.createElementNS(SVG_NS,"text"); text.textContent=n.key; a.appendChild(text);
        const show=()=>showConnections(n.key); const hide=()=>clearConnections();
        a.addEventListener('mouseenter',show); a.addEventListener('mouseleave',hide);
        a.addEventListener('mouseover',show);  a.addEventListener('mouseout',hide);
        a.addEventListener('focusin',show);    a.addEventListener('focusout',hide);
        group.appendChild(a);
      });
    });
  }

  function showConnections(srcKey){
    clearConnections();
    const src=posByKey.get(srcKey); if(!src) return;
    const targets=new Set([
      ...(CONNECTIONS[srcKey]||[]),
      ...Object.entries(CONNECTIONS).filter(([k,arr])=>(arr||[]).includes(srcKey)).map(([k])=>k)
    ]);
    const srcEl=nodeElByKey.get(srcKey); if(srcEl) srcEl.classList.add('active');
    targets.forEach(tKey=>{
      const dst=posByKey.get(tKey), dstEl=nodeElByKey.get(tKey);
      if(!dst||!dstEl) return;
      const tNode=nodes.find(n=>n.key===tKey);
      let cls="link-mid"; if(tNode.ring==="inner") cls="link-inner"; else if(tNode.ring==="outer") cls="link-outer";
      const line=document.createElementNS(SVG_NS,"line");
      line.setAttribute("x1",src.x); line.setAttribute("y1",src.y);
      line.setAttribute("x2",dst.x); line.setAttribute("y2",dst.y);
      line.setAttribute("class",cls); linkLayer.appendChild(line);
      dstEl.classList.add('linked');
    });
  }

  function clearConnections(){ while(linkLayer.firstChild) linkLayer.removeChild(linkLayer.firstChild); nodeElByKey.forEach(el=>el.classList.remove('linked','active')); }

  placeNodes();
  svg.appendChild(linkLayer); requestAnimationFrame(()=>svg.appendChild(linkLayer));

  // RESETBOX klickbar
  (function(){
    const reset=document.getElementById('reset'); if(!reset) return;
    const url=`${BASE}module.html?file=${encodeURIComponent('README.md')}&v=${encodeURIComponent(V)}`;
    reset.style.cursor='pointer'; const go=()=>{try{window.location.assign(url);}catch(e){location.href=url;}};
    reset.addEventListener('click',e=>{e.preventDefault();go();});
    reset.addEventListener('touchend',e=>{e.preventDefault();go();},{passive:false});
    reset.addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();go();}});
  })();
})();
</script>
</body>
</html>
