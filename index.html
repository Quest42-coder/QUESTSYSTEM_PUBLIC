<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QUESTSYSTEM – Modul-Ringe</title>
  <style>
    :root {
      --bg:#0e1116; --fg:#e7eef7;
      --inner:#f3c0c7; --mid:#f0de94; --outer:#bcd5ff;
      --node-bg:#1a202c; --node-border:#444; --hover:#66ccff;
      --shadow:0 4px 12px rgba(0,0,0,.4);
    }
    body {
      margin:0; background:var(--bg); color:var(--fg);
      font-family:system-ui,sans-serif; overflow:hidden;
    }
    svg { width:100vw; height:100vh; }
    .ring { fill:none; stroke-width:2; stroke-opacity:.4; }
    .ring.inner { stroke:var(--inner); }
    .ring.mid   { stroke:var(--mid); }
    .ring.outer { stroke:var(--outer); }
    .node circle {
      fill:var(--node-bg); stroke:var(--node-border);
      stroke-width:2; r:50;
    }
    .node text {
      fill:var(--fg); font-size:14px; font-weight:600;
      text-anchor:middle; dominant-baseline:middle;
      pointer-events:none;
    }
    .node:hover circle { stroke:var(--hover); stroke-width:3; }
    .center circle { fill:var(--node-bg); stroke:var(--hover); stroke-width:3; r:80; }
    .center text {
      fill:var(--fg); font-size:20px; font-weight:700;
      text-anchor:middle; dominant-baseline:middle;
    }
    line.link {
      stroke:var(--hover); stroke-width:2;
      opacity:0; pointer-events:none;
    }
    .node:hover ~ .links line[data-from],
    .node:hover ~ .links line[data-to] { opacity:.6; }
  </style>
</head>
<body>
  <svg id="map" viewBox="-700 -700 1400 1400">
    <!-- Ringe -->
    <circle class="ring inner" r="220"/>
    <circle class="ring mid"   r="380"/>
    <circle class="ring outer" r="540"/>

    <!-- Resetbox Zentrum -->
    <a class="center" href="module.html?file=MODULES/Modul_01_RESETBOX.md">
      <circle></circle>
      <text>RESETBOX</text>
    </a>

    <!-- Container für Module -->
    <g id="nodes"></g>
    <!-- Container für Verbindungen -->
    <g class="links"></g>
  </svg>

<script>
const BASE = location.origin + location.pathname.replace(/index\.html$/,'');
const urlFor = f => `${BASE}module.html?file=${encodeURIComponent(f)}`;

const modules = [
  {id:"02",label:"WATER",   ring:"inner", file:"MODULES/Modul_02_WATER.md",   links:["04","06","13"]},
  {id:"03",label:"SHELTER", ring:"inner", file:"MODULES/Modul_03_SHELTER.md", links:["05","13","01"]},
  {id:"04",label:"FOOD",    ring:"inner", file:"MODULES/Modul_04_FOOD.md",    links:["02","13","25"]},
  {id:"05",label:"SLEEP",   ring:"inner", file:"MODULES/Modul_05_SLEEP.md",   links:["03","07","06"]},
  {id:"06",label:"BODY",    ring:"inner", file:"MODULES/Modul_06_BODY.md",    links:["02","05","07"]},
  {id:"07",label:"PSYCHE",  ring:"inner", file:"MODULES/Modul_07_PSYCHE.md",  links:["05","06","30"]},
  {id:"08",label:"DEVICE",  ring:"inner", file:"MODULES/Modul_08_DEVICE.md",  links:["20","32","01"]},
  {id:"09",label:"DEBT",    ring:"inner", file:"MODULES/Modul_09_DEBT.md",    links:["10","25","01"]},

  {id:"10",label:"WORK",    ring:"mid", file:"MODULES/Modul_10_WORK.md",   links:["09","11","25"]},
  {id:"11",label:"SCHOOL",  ring:"mid", file:"MODULES/Modul_11_SCHOOL.md", links:["10","30","07"]},
  {id:"12",label:"BORDER",  ring:"mid", file:"MODULES/Modul_12_BORDER.md", links:["01","13","36"]},
  {id:"13",label:"NATURE",  ring:"mid", file:"MODULES/Modul_13_NATURE.md", links:["02","04","20"]},
  {id:"14",label:"HEALTH",  ring:"mid", file:"MODULES/Modul_14_HEALTH.md", links:["02","06","07"]},
  {id:"15",label:"CARE",    ring:"mid", file:"MODULES/Modul_15_CARE.md",   links:["14","07","01"]},
  {id:"16",label:"FAMILY",  ring:"mid", file:"MODULES/Modul_16_FAMILY.md", links:["05","11","14"]},
  {id:"17",label:"ANIMAL",  ring:"mid", file:"MODULES/Modul_17_ANIMAL.md", links:["04","13","14"]},
  {id:"18",label:"CULTURE", ring:"mid", file:"MODULES/Modul_18_CULTURE.md",links:["11","30","29"]},
  {id:"19",label:"MEDIA",   ring:"mid", file:"MODULES/Modul_19_MEDIA.md",  links:["30","32","11"]},
  {id:"20",label:"ENERGY",  ring:"mid", file:"MODULES/Modul_20_ENERGY.md", links:["08","13","25"]},
  {id:"21",label:"CLIMATE", ring:"mid", file:"MODULES/Modul_21_CLIMATE.md",links:["13","20","14"]},
  {id:"22",label:"MIGRATION",ring:"mid",file:"MODULES/Modul_22_MIGRATION.md",links:["12","13","36"]},
  {id:"23",label:"JUSTICE", ring:"mid", file:"MODULES/Modul_23_JUSTICE.md",links:["09","10","32"]},
  {id:"24",label:"COMMUNITY",ring:"mid",file:"MODULES/Modul_24_COMMUNITY.md",links:["11","18","23"]},

  {id:"25",label:"FINANCE", ring:"outer",file:"MODULES/Modul_25_FINANCE.md",links:["09","10","20"]},
  {id:"26",label:"HOUSING", ring:"outer",file:"MODULES/Modul_26_HOUSING.md",links:["03","05","25"]},
  {id:"27",label:"TRANSPORT",ring:"outer",file:"MODULES/Modul_27_TRANSPORT.md",links:["02","20","22"]},
  {id:"28",label:"NETWORK", ring:"outer",file:"MODULES/Modul_28_NETWORK.md",links:["08","20","19"]},
  {id:"29",label:"SYMBOL",  ring:"outer",file:"MODULES/Modul_29_SYMBOL.md", links:["18","24","30"]},
  {id:"30",label:"TRUTH",   ring:"outer",file:"MODULES/Modul_30_TRUTH.md",  links:["11","19","32"]},
  {id:"31",label:"MEMORY",  ring:"outer",file:"MODULES/Modul_31_MEMORY.md", links:["11","29","30"]},
  {id:"32",label:"LICENCE", ring:"outer",file:"MODULES/Modul_32_LICENCE.md",links:["19","30","08"]},
  {id:"33",label:"PRIVACY", ring:"outer",file:"MODULES/Modul_33_PRIVACY.md",links:["08","19","32"]},
  {id:"34",label:"SECURITY",ring:"outer",file:"MODULES/Modul_34_SECURITY.md",links:["01","12","36"]},
  {id:"35",label:"DATA",    ring:"outer",file:"MODULES/Modul_35_DATA.md",   links:["08","28","32"]},
  {id:"36",label:"CONFLICT",ring:"outer",file:"MODULES/Modul_36_CONFLICT.md",links:["12","22","34"]},
  {id:"37",label:"DEMOCRACY",ring:"outer",file:"MODULES/Modul_37_DEMOCRACY.md",links:["23","24","25"]},
  {id:"38",label:"GOVERNANCE",ring:"outer",file:"MODULES/Modul_38_GOVERNANCE.md",links:["23","37","25"]},
  {id:"39",label:"KNOWLEDGE",ring:"outer",file:"MODULES/Modul_39_KNOWLEDGE.md",links:["11","30","31"]},
  {id:"40",label:"ART",     ring:"outer",file:"MODULES/Modul_40_ART.md",    links:["18","29","39"]},
  {id:"41",label:"FUTURE",  ring:"outer",file:"MODULES/Modul_41_FUTURE.md", links:["21","39","40"]},
  {id:"42",label:"DEATH",   ring:"outer",file:"MODULES/Modul_42_DEATH.md",  links:["14","15","41"]},
];

// Koordinatenberechnung
const rings = {inner:220, mid:380, outer:540};
const svg = document.getElementById("map");
const gNodes = document.getElementById("nodes");
const gLinks = document.querySelector(".links");

let positions={};
["inner","mid","outer"].forEach(ring=>{
  const list=modules.filter(m=>m.ring===ring);
  const step=2*Math.PI/list.length;
  list.forEach((m,i)=>{
    const angle=-Math.PI/2+i*step;
    const x=Math.cos(angle)*rings[ring];
    const y=Math.sin(angle)*rings[ring];
    positions[m.id]={x,y};
    const a=document.createElementNS("http://www.w3.org/2000/svg","a");
    a.setAttribute("href",urlFor(m.file));
    a.classList.add("node");
    a.setAttribute("transform",`translate(${x},${y})`);
    const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
    const t=document.createElementNS("http://www.w3.org/2000/svg","text");
    t.textContent=m.label;
    a.appendChild(c); a.appendChild(t);
    gNodes.appendChild(a);
    // Hover Links
    a.addEventListener("mouseenter",()=>{
      Array.from(gLinks.children).forEach(line=>{
        if(line.dataset.from===m.id||line.dataset.to===m.id){
          line.style.opacity=0.6;
        }
      });
    });
    a.addEventListener("mouseleave",()=>{
      Array.from(gLinks.children).forEach(line=>line.style.opacity=0);
    });
  });
});

// Links einzeichnen
modules.forEach(m=>{
  m.links.forEach(lid=>{
    if(positions[m.id]&&positions[lid]){
      const l=document.createElementNS("http://www.w3.org/2000/svg","line");
      l.setAttribute("x1",positions[m.id].x);
      l.setAttribute("y1",positions[m.id].y);
      l.setAttribute("x2",positions[lid].x);
      l.setAttribute("y2",positions[lid].y);
      l.classList.add("link");
      l.dataset.from=m.id; l.dataset.to=lid;
      gLinks.appendChild(l);
    }
  });
});
</script>
</body>
</html>
